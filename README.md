For those curious as to how this works, I have provided a link to a google drive containing 
a 16 page, handwritten documentation regarding every term pertinent to the simulation, and the process by which the simulation calculates those terms.
Thank you for checking this out :)

https://drive.google.com/file/d/1LDA0XGC9khYIZI091B0D0WqXge9hfjZ_/view?usp=sharing
